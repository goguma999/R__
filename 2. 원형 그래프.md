### 2. 원형 그래프

### 📍Code1_R 내장 함수를 이용한 원형 그래프

```r
setwd('c:\\data')
emp<- read.csv('emp.csv',header=T)

job_cnt <- table(emp$job)

pie( job_cnt, 
     main="직업별 빈도 원형 그래프" ,
     col=rainbow( length(job_cnt) ),
     labels= paste(names(job_cnt), "\n", job_cnt ) )

colors <- c("skyblue", "coral", "seagreen", "gold", "orchid")

pie( job_cnt, 
     main="직업별 빈도 원형 그래프" ,
     col= colors,
     labels= paste(names(job_cnt), "\n", job_cnt ) )
```

### 📍Code2_plotly로 원형 그래프 그리기
```r
#데이터 로드 
library(plotly)
setwd('c:\\data')
emp<- read.csv('emp.csv',header=T)

#직업별 인원수 계산
job_cnt <- table(emp$job) -- 테이블로, 가로로 표가 있어야 데이터 생성 편함

#색상 목록 정의
colors <- c('gold','skyblue','tomato','lightgreen','purple')

#plotly를 사용한 원형 그래프 생성
fig <- plot_ly ( labels=names(job_cnt),
		 values=as.numeric(job_cnt),
		 type='pie',
		 marker=list(colors=colors) ) 
									
#그래프 출력
fig 				

*str(job_cnt) = integer 숫자임					
```

![plotly는 비율까지 저절로 같이 나옴 ](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/3d648330-1f39-4be6-8925-5e9b2236ac59/Untitled.png)


▪️문제97. 데이터 시각화를 빠르게 하기 위해 모아놓은 활용 코드를 빠르게 불러올 수 있게 하는 switch 함수 사용법을 연습합니다.

```r
# 사용자가 선택할 수 있는 옵션 출력 
cat('1: 막대 그래프 코드 \n')
cat('2: 원형 그래프 코드 \n')
cat('번호를 선택하세요: ')

# 사용자 입력 받기 
num<- as.integer( readLines(con=stdin(), n=1))

# switch 문을 사용해서 선택에 따라 다른 메세지 출력
result<- switch( num,
    '1'='첫번째 옵션을 선택했습니다.',
    '2'='두번째 옵션을 선택했습니다.', -- 여기에 코드를 가져다 넣는
    '유효하지 않은 선택입니다.'
    ) 
    
잘 안 되어서 메모장 열어서 다른 이름으로 저장
c드라이브-데이터에, 맨 끝에 확장자명 .r로. 파일형식은 '모든파일'로 저장 

다시 스튜디오서 
setwd('c:\\data')
source('ann.R') -> 실행이 됨
```

▪️문제98. bar_plot.R 이라는 이름으로 여러분들이 빨리 가져다 쓸 수 있는 막대 그래프 그리는 코드를 c:\\data 밑에 저장하시오 ! 

```r
#직업별 인원수 계산
job_counts<-table(emp$job)

#RColorBrewer 팔레트 중에서 5가지 색상 선택
install.packages("RColorBrewer")
library(RColorBrewer)
colors<-brewer.pal(5,'Set3')

#plotly를 사용한 막대 그래프 생성
fig<-plot_ly(x=names(job_counts),y=as.numeric(job_counts),type='bar',
							marker=list(color=colors))

#그래프 출력
fig

-> bar_plot.R 
```

▪️문제99. bar_plot.R 스크립트를 화면에 출력하게 하시오 ! 

```r
cat ( readLines('bar_plot.R', sep='\n')
```

→ readLines 함수로 bar_plot.R을 불러오고 cat으로 화면에 코드를 출력하는데 sep=’\n’으로 라인과 라인은 엔터로 구분해서 출력하겠다라고 합니다. 

▪️문제100. 특급 데이터 분석가 코드처럼 시각화 코드 모음을 불러오는 코드에 문제99번 스크립트를 추가하시오 ! 

```r
ann.R 스크립트를 열고 아래내용을 수정. 
result <- switch( num, 
                  "1" = **cat( readLines("bar_plot.R"), sep = "\n")**,
                  "2" = "두번째 옵션을 선택했습니다.",
                  "유효하지 않은 선택입니다."
)

cat(result, "\n")
```

▪️문제101. 원형 그래프 코드도 쉽게 사용할 수 있도록 ann.r에 두번째 번호에 추가하시오 ! 

```r

```

[▪️문제60. 일반 원형 그래프에 job_label을 사용해서 시각화하시오 ! ](https://www.notion.so/60-job_label-75e6730fc84540cc96cba149b9a12d59?pvs=21) 

**[0701점심문제]**

부서명과 부서명별 토탈월급의 비율을 다음과 같이 원형 그래프로 시각화 하시오 !

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/796a19a1-447d-49cf-ad5b-a68c130cf18f/Untitled.png)

```r
empdept <- merge(emp, dept, by='deptno')
x<-aggregate(sal~dname,empdept,sum)
names(x)<-c('부서명','토탈월급')
x

pct<- round(x$sal/sum(x$sal)*100,1)
pct
dname_label<-paste(x$부서명,':',pct,'%')

pie(x2, labels=dname_label, 
		col=c('tomato','gold','greenyellow'), density=500)
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/cb25ebce-13cd-47f0-ba90-501bdb570330/Untitled.png)
