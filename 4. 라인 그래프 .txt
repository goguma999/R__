4. ë¼ì¸ ê·¸ë˜í”„ 

### â€» ë¼ì¸ ê·¸ë˜í”„ê°€ ìœ ìš©í•œ ê²½ìš° 3ê°€ì§€ ?

1. ì‹œê°„ì— ë”°ë¥¸ ë³€í™” ì¶”ì ì„ í™•ì¸í•  ë•Œ ë§¤ìš° íš¨ê³¼ì ì¸ ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
2. ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì‹œê°í™” í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.
    
    ex. ì œí’ˆì˜ ê°€ê²© ë³€ë™ê³¼ íŒë§¤ëŸ‰ê³¼ì˜ ê´€ê³„
    
3. ê²½í–¥ì„± ë¶„ì„ì„ í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. 
    
    ex. ë…„ë„ë³„ë¡œ ì¶œì‚°ìœ¨ì´ ì €í•˜ë˜ëŠ”ì§€ í™•ì¸ 
    

### ğŸ“ë¬¸ë²•1. plotlyë¡œ ë¼ì¸ ê·¸ë˜í”„ë¡œ ì‹œê°í™”_ê°•ë‚¨ì—­ ì‹œê°„ëŒ€ë³„ ìŠ¹ì°¨ìˆ˜

[ë°ì´í„°](https://cafe.daum.net/oracleoracle/Soei/30)

```r
#ì˜ˆì œ1. ìŠ¹ì°¨ìˆ˜ ë¼ì¸ë§Œ ì¶œë ¥í•˜ì‹œì˜¤

# plotly íŒ¨í‚¤ì§€ ë¡œë“œ
library(plotly)

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
setwd("c:\\data")

# ë°ì´í„° ë¡œë“œ
data <- read.csv("line2.csv", header = TRUE, fileEncoding = "euc-kr")
data

# plotlyë¥¼ ì‚¬ìš©í•œ ë¼ì¸ ê·¸ë˜í”„ ìƒì„± (ìŠ¹ì°¨ìˆ˜ ë¼ì¸ë§Œ ì¶œë ¥)
fig <- plot_ly(data, x = ~time) %>%
  add_trace(y = ~in_cnt, name = 'ìŠ¹ì°¨', type = 'scatter', 
  mode = 'lines+markers', line = list(color = 'blue'))
									â”” ë™ê¸€ë±…ì´

# ê·¸ë˜í”„ ì¶œë ¥
fig
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/81feeb62-ef1d-4c5c-864a-5f7fa1d4dd73/Untitled.png)

### ğŸ“ë¬¸ë²•2. ìœ„ì˜ ê·¸ë˜í”„ì— í•˜ì°¨ìˆ˜ë„ ë¼ì¸ ê·¸ë˜í”„ë¡œ ì¶”ê°€í•˜ì‹œì˜¤ !

```r
#ì˜ˆì œ2. í•˜ì°¨ìˆ˜ ë¼ì¸ë§Œ ì¶œë ¥í•˜ì‹œì˜¤

# plotlyë¥¼ ì‚¬ìš©í•œ ë¼ì¸ ê·¸ë˜í”„ ìƒì„± (ìŠ¹ì°¨ìˆ˜ ë¼ì¸ë§Œ ì¶œë ¥)
fig <- plot_ly(data, x = ~time) %>%
  add_trace(y = ~in_cnt, name = 'ìŠ¹ì°¨', type = 'scatter', 
		  mode = 'lines+markers', line = list(color = 'blue')) %>% 
  add_trace( y= ~out_cnt, name = 'í•˜ì°¨', type = 'scatter', 
		  mode = 'lines+markers', line = list(color = 'red'))

# ê·¸ë˜í”„ ì¶œë ¥
fig
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/8d6786da-9841-4a40-ab62-292cfd5323ea/Untitled.png)

ë¬¸ì œ103. [í•œêµ­ ì¶œì‚°ìœ¨ ë°ì´í„°](https://cafe.daum.net/oracleoracle/Soei/31)(korea_birth)ë¥¼ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ìƒì„±í•˜ì‹œì˜¤ ! 

```r
korea_birth<- read.csv('korea_birth.csv',header=T)
head(korea_birth,5)
*year = ë…„ë„, *birth_rate=ì¶œìƒë¥  
```

ë¬¸ì œ104. ìœ„ì˜ ë°ì´í„°ë¥¼ ì´ìš©í•´ì„œ ì´í•´í•˜ê¸° ì¢‹ë„ë¡ ë¼ì¸ ê·¸ë˜í”„ë¡œ ì‹œê°í™” í•˜ì‹œì˜¤ ! 

```r
fig<- plot_ly(korea_birth, x = ~k_year) %>%
  add_trace(y= ~birth_rate, name = 'ì¶œì‚°ìœ¨', type='scatter',
            mode='lines+markers', 
            line=list(color='blue'), marker=list(color='skyblue'))
fig
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/8de9924d-255e-4292-92af-be7d78b75166/Untitled.png)

```r
fig<- fig %>% layout(title='1970-2023ë…„ê¹Œì§€ì˜ í•œêµ­ì˜ ì¶œì‚°ìœ¨')
fig
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/f24cff16-f3e7-4ad3-95c4-d6cbeef8222f/Untitled.png)

ë¬¸ì œ105. [ì¼ë³¸ì˜ ì¶œì‚°ìœ¨ ë°ì´í„°](https://cafe.daum.net/oracleoracle/Sotv/188)ë¥¼ ê°€ì§€ê³  csv íŒŒì¼ì„ ìƒì„±í•´ì„œ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ìƒì„±í•˜ì‹œì˜¤ ! 

```r
í…ìŠ¤íŠ¸ -> ë©”ëª¨ì¥ -> csvë¡œ ì €ì¥ 

japan_birth<- read.csv('japan_birth.csv',header=T)
```

ë¬¸ì œ106. í•œêµ­ì˜ ì¶œì‚°ìœ¨ ë¼ì¸ ê·¸ë˜í”„ì— ì¼ë³¸ì˜ ì¶œì‚°ìœ¨ ë¼ì¸ ê·¸ë˜í”„ë¥¼ ê°™ì´ ì¶œë ¥í•˜ì‹œì˜¤ ! ë°ì´í„° [ì—¬ê¸°](https://cafe.daum.net/oracleoracle/Soei/36)

```r
# plotly íŒ¨í‚¤ì§€ ë¡œë“œ
library(plotly)

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
setwd("c:\\data")

# í•œêµ­ ì¶œì‚°ìœ¨ ë°ì´í„° ë¡œë“œ
korea_data <- read.csv("korea2.csv", header = TRUE, fileEncoding = "euc-kr")

# ì¼ë³¸ ì¶œì‚°ìœ¨ ë°ì´í„° ë¡œë“œ
japan_data <- read.csv("japan2.csv", header = TRUE)

# ë°ì´í„° í”„ë ˆì„ì„ í•©ì¹˜ê¸° ìœ„í•´ ì—´ ì´ë¦„ í†µì¼
colnames(korea_data) <- c("year", "birth_rate")
colnames(japan_data) <- c("year", "birth_rate")

**# ì¶œì²˜ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ì—´ ì¶”ê°€**
korea_data$country <- "Korea"
japan_data$country <- "Japan"

**# ë‘ ë°ì´í„°ë¥¼ í•©ì¹˜ê¸°**
combined_data <- rbind(korea_data, japan_data)

# plotlyë¥¼ ì‚¬ìš©í•œ ë¼ì¸ ê·¸ë˜í”„ ìƒì„±
fig <- plot_ly(combined_data, **x = ~year,** **y = ~birth_rate**, 
**color = ~country**, **colors** = c('blue', 'red'), type = 'scatter', mode = 'lines+markers')
**â”” ì¡°ê±´ì„ ì–´ë–»ê²Œ ì“°ë‚˜ í–ˆëŠ”ë° ê± colorë¡œ êµ¬ë¶„í•´ë²„ë¦¼(colorsì•„ë‹˜)** 

# ê·¸ë˜í”„ ì¶œë ¥
fig

-> color=~countryë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ êµ­ê°€ë³„ë¡œ ë‹¤ë¥¸ ìƒ‰ìƒì„ ì‚¬ìš©í•©ë‹ˆë‹¤. 
êµ­ê°€ë³„ë¡œ ë¼ì¸ ê·¸ë˜í”„ê°€ ê·¸ë ¤ì§€ëŠ”ë° colors = c('blue','red')ë¥¼ ì§€ì •í•´ì„œ ë¼ì¸ ìƒ‰ê¹”ë¡œ
êµ­ê°€ë¥¼ êµ¬ë¶„í•©ë‹ˆë‹¤. 
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/ae16796d-d6f0-41d7-ad66-086deef69318/Untitled.png)

ğŸ“ë¬¸ë²•107. [1~4í˜¸ì„ ìŠ¹í•˜ì°¨ìŠ¹ê°ìˆ˜_ìˆ˜ì •ëœ ê²ƒ](https://cafe.daum.net/oracleoracle/Soei/37) ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ë°ì´í„° í”„ë ˆì„ì„ ìƒì„±í•˜ì‹œì˜¤ 

```r
data<-read.csv('line14.csv',header=T)
data
```

ë¬¸ì œ108. 1-4í˜¸ì„ ìŠ¹í•˜ì°¨ìŠ¹ê°ìˆ˜_ìˆ˜ì •ëœê²ƒ(line14) ë°ì´í„°ë¥¼ ê°€ì§€ê³  ë¼ì¸ ê·¸ë˜í”„ë¡œ ì‹œê°í™” í•˜ì‹œì˜¤ ! í˜¸ì„ ë³„ë¡œ 4ê°œì˜ ê·¸ë˜í”„ê°€ ì¶œë ¥ ë˜ê²Œ í•˜ë©´ ë©ë‹ˆë‹¤. xì¶•ì€ ì‹œê°„ì´ê³  yì¶•ì€ ìŠ¹ê°ìˆ˜ì¸ë° ìŠ¹ì°¨ìˆ˜(in)ë§Œ ê°€ì§€ê³  ë¼ì¸ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ì„¸ìš” ! 

```r
fig<- plot_ly(line14, x= ~time, y = ~in.,
              **color = ~line_no**, 
              colors = colors, type = 'scatter', mode = 'lines+markers') 

fig
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/6d768b58-b719-4e61-a559-6858d7557916/Untitled.png)

**ë¬¸ì œ109. ìë™í™” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ì‹œ ì‚¬ìš©í•˜ê¸° ì¢‹ë„ë¡ ìˆ˜ì •í•œ ì½”ë“œë¡œ ë°˜ì˜í•˜ì„¸ìš”. [ì„ ìƒë‹˜ ìŠ¤í¬ë¦½íŠ¸](https://cafe.daum.net/oracleoracle/Sotv/186)**

```r
# í•„ìš”í•œ íŒ¨í‚¤ì§€ ë¡œë“œ
library(svDialogs)
library(plotly)

# ì˜µì…˜ ë©”ì‹œì§€ ì •ì˜
options_list <- list("1: ë§‰ëŒ€ ê·¸ë˜í”„ ì½”ë“œ", "2: ì›í˜• ê·¸ë˜í”„ ì½”ë“œ")

# ì‚¬ìš©ì ì…ë ¥ ë°›ê¸° (ëŒ€í™” ìƒì ì‚¬ìš©)
dialog_result <- dlgList(options_list, title = "ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”")$res

# switch ë¬¸ì„ ì‚¬ìš©í•´ì„œ ì„ íƒì— ë”°ë¼ ë‹¤ë¥¸ ë©”ì„¸ì§€ ì¶œë ¥ ë° ì‹¤í–‰
if (is.null(dialog_result)) { #<--- ë§Œì•½ ê²°ì¸¡ì¹˜ê°€ ìˆë‹¤ë©´
  cat("ìœ íš¨í•˜ì§€ ì•Šì€ ì„ íƒì…ë‹ˆë‹¤.\n")
} else {
  num <- as.integer(substr(dialog_result, 1, 1)) # ì„ íƒí•œ ì˜µì…˜ì˜ ì²« ê¸€ìë¥¼ ìˆ«ìë¡œ ë³€í™˜
  fig <- switch(as.character(num),
         "1" = {
           cat(readLines("bar_plot.R"), sep = "\n")
           source("bar_plot.R", local = TRUE)
           fig  # bar_plot.Rì—ì„œ ìƒì„±ëœ fig ê°ì²´ ë°˜í™˜
         },
         "2" = {
           cat(readLines("pie_plot.R"), sep = "\n")
           source("pie_plot.R", local = TRUE)
           fig  # pie_plot.Rì—ì„œ ìƒì„±ëœ fig ê°ì²´ ë°˜í™˜
         },
         {
           cat("ìœ íš¨í•˜ì§€ ì•Šì€ ì„ íƒì…ë‹ˆë‹¤.\n")
           NULL
         }
  )
  if (!is.null(fig)) {
    print(fig)  # fig ê°ì²´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì¶œë ¥
  }
}
```

![í´ë¦­ë§Œ í•˜ë©´ ë¨. ê·¸ë˜í”„ë„ ë‚˜ì˜´; ì´ê²ƒì´ í…Œí¬. ë¯¸ì³£ë‹¤ë¦¬ ~ ](https://prod-files-secure.s3.us-west-2.amazonaws.com/08691aea-b5b9-4275-80cd-5d0d824962f4/f75d5b12-ff35-4848-9799-7e149ba23e19/Untitled.png)

í´ë¦­ë§Œ í•˜ë©´ ë¨. ê·¸ë˜í”„ë„ ë‚˜ì˜´; ì´ê²ƒì´ í…Œí¬. ë¯¸ì³£ë‹¤ë¦¬ ~ 

ë¬¸ì œ110. ì§€í•˜ì²  1~4í˜¸ì„  ìŠ¹ì°¨ìˆ˜ë¥¼ ë¼ì¸ ê·¸ë˜í”„ë¡œ ì¶œë ¥í•˜ëŠ”ë° ì•„ë˜ì˜ ì½”ë“œë¥¼ line_plot.Rì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ cë“œë¼ì´ë¸Œ ë°‘ì— data í´ë” ë°‘ì— ì €ì¥í•˜ì„¸ìš” ~ 

```r
library(plotly)
data<- read.csv('line14.csv',header=T)

fig<- plot_ly(data, x= ~time, y = ~in.,
              color = ~line_no, 
              colors = colors, type = 'scatter', mode = 'lines+markers') 
fig
```

ë¬¸ì œ111. ann.Rì— 3ë²ˆ ì½”ë“œë¡œ line_plot.Rì„ ì¶”ê°€í•˜ì‹œì˜¤ ! 

```r
# í•„ìš”í•œ íŒ¨í‚¤ì§€ ë¡œë“œ
library(svDialogs)
library(plotly)

# ì˜µì…˜ ë©”ì‹œì§€ ì •ì˜
options_list <- list("1: ë§‰ëŒ€ ê·¸ë˜í”„ ì½”ë“œ", "2: ì›í˜• ê·¸ë˜í”„ ì½”ë“œ", **"3: ë¼ì¸ ê·¸ë˜í”„ ì½”ë“œ"**)

# ì‚¬ìš©ì ì…ë ¥ ë°›ê¸° (ëŒ€í™” ìƒì ì‚¬ìš©)
dialog_result <- dlgList(options_list, title = "ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš”")$res

# switch ë¬¸ì„ ì‚¬ìš©í•´ì„œ ì„ íƒì— ë”°ë¼ ë‹¤ë¥¸ ë©”ì„¸ì§€ ì¶œë ¥ ë° ì‹¤í–‰
if (is.null(dialog_result)) {
  cat("ìœ íš¨í•˜ì§€ ì•Šì€ ì„ íƒì…ë‹ˆë‹¤.\n")
} else {
  num <- as.integer(substr(dialog_result, 1, 1)) # ì„ íƒí•œ ì˜µì…˜ì˜ ì²« ê¸€ìë¥¼ ìˆ«ìë¡œ ë³€í™˜
  fig <- switch(as.character(num),
         "1" = {
           cat(readLines("bar_plot.R"), sep = "\n")
           source("bar_plot.R", local = TRUE)
           fig  # bar_plot.Rì—ì„œ ìƒì„±ëœ fig ê°ì²´ ë°˜í™˜
         },
         "2" = {
           cat(readLines("pie_plot.R"), sep = "\n")
           source("pie_plot.R", local = TRUE)
           fig  # pie_plot.Rì—ì„œ ìƒì„±ëœ fig ê°ì²´ ë°˜í™˜
         },
         **"3" = {
           cat(readLines("line_plot.R"), sep = "\n")
           source("line_plot.R", local = TRUE)
           fig  # line_plot.Rì—ì„œ ìƒì„±ëœ fig ê°ì²´ ë°˜í™˜
         },**
         {
           cat("ìœ íš¨í•˜ì§€ ì•Šì€ ì„ íƒì…ë‹ˆë‹¤.\n")
           NULL
         }
  )
  if (!is.null(fig)) {
    print(fig)  # fig ê°ì²´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì¶œë ¥
  }
}
```